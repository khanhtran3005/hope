function initReliableSignaler(a,b){function d(){c&&a&&a.isInitiator&&a.roomid&&c.emit("keep-session",a.roomid),c.on("connect",function(){c.isHavingError&&d()}),c.on("message",function(a){e[a.channel]&&e[a.channel](a.message)}),c.on("error",function(){c.isHavingError=!0,d()}),c.on("disconnect",function(){c.isHavingError=!0,d()})}function f(a,b){window.removeEventListener(a,b),window.addEventListener(a,b,!1)}function g(){return navigator.onLine?(c.isHavingError&&d(),void 0):(console.warn("Internet channel seems disconnected."),void 0)}function h(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var a=window.crypto.getRandomValues(new Uint32Array(3)),b="",c=0,d=a.length;d>c;c++)b+=a[c].toString(36);return b}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}var c=b;if(!a)throw'"connection" argument is required.';d();var e={};return a.openSignalingChannel=function(b){var d=b.channel||this.channel||"default-channel";return e[d]=b.onmessage,b.onopen&&setTimeout(b.onopen,1),{send:function(b){c.emit("message",{sender:a.userid,channel:d,message:b})},channel:d}},f("load",g),f("online",g),f("offline",g),{socket:c,createNewRoomOnServer:function(b,d){a.roomid=b,a.isInitiator=!0,a.userid=a.userid||h(),c.emit("keep-in-server",b||a.channel,d||function(){})},getRoomFromServer:function(b,d){return void 0===b.userId?(alert("You need to login first"),void 0):(a.userid=b.userId||h(),c.emit("get-session-info",b,d),void 0)}}}