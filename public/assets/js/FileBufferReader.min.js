!function(){function c(a,b){if(a||(a={}),!b)return a;for(var c in b)a[c]=b[c];return a}window.FileBufferReader=function(){var c=this;c.chunks={},c.readAsArrayBuffer=function(b,d,e){e=e||{},e.chunkSize=e.chunkSize||12e3,a.Read(b,function(a){b.extra=e||{},b.url=URL.createObjectURL(b),a.file=b,c.chunks[a.uuid]=a,d(a.uuid)},e)},c.getNextChunk=function(a,d){var e=c.chunks[a];if(e){var f=e.listOfChunks[e.currentPosition],g=f&&f.end;b.ConvertToArrayBuffer(f,function(b){0==e.currentPosition&&c.onBegin(e.file),g&&c.onEnd(e.file),d(b,g,f.extra),c.onProgress({currentPosition:e.currentPosition,maxChunks:e.maxChunks,uuid:e.uuid,extra:f.extra}),c.chunks[a].currentPosition++})}},c.onBegin=c.onProgress=c.onEnd=function(){};var d=new a.Receiver(c);c.addChunk=function(a,c){d.receive(a,function(a){b.ConvertToArrayBuffer({readyForNextChunk:!0,uuid:a},c)})},c.convertToObject=b.ConvertToObject,c.convertToArrayBuffer=b.ConvertToArrayBuffer},window.FileSelector=function(){function b(a,b){var d=document.createElement("input");d.type="file",b&&(d.multiple=!0),d.onchange=function(){a(b?d.files:d.files[0])},c(d)}function c(a){var b=new window.MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});a.dispatchEvent(b)}var a=this;a.selectSingleFile=b,a.selectMultipleFiles=function(a){b(a,!0)}};var a={Read:function(a,b,c){function q(a,b,i){d=Math.ceil(b.byteLength/h);for(var j=0;d>j;j++){var k=j*h;g[e]={uuid:n,value:b.slice(k,Math.min(k+h,b.byteLength)),currentPosition:e,maxChunks:m,extra:c},e++}e==m&&(f=!0),i()}var d,f,e=1,g={},h=c.chunkSize||6e4,i=0,j=h,k=Math.floor(Math.min(1e8,j)/h),l=k*h,m=Math.ceil(a.size/h),n=a.uuid||(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"-");g[0]={uuid:n,maxChunks:m,size:a.size,name:a.name,lastModifiedDate:a.lastModifiedDate+"",type:a.type,start:!0,extra:c},a.maxChunks=m,a.uuid=n;var o,p=new FileReader;p.onloadend=function(d){d.target.readyState==FileReader.DONE&&q(a.name,d.target.result,function(){i++,(i+1)*l<a.size?(o=a.slice(i*l,(i+1)*l),p.readAsArrayBuffer(o)):i*l<a.size?(o=a.slice(i*l,a.size),p.readAsArrayBuffer(o)):(g[e]={uuid:n,maxChunks:m,size:a.size,name:a.name,lastModifiedDate:a.lastModifiedDate+"",type:a.type,end:!0,extra:c},b({currentPosition:0,listOfChunks:g,maxChunks:m+1,uuid:n,extra:c}))})},o=a.slice(i*l,(i+1)*l),p.readAsArrayBuffer(o)},Receiver:function(a){function e(f,g){if(!f.uuid)return b.ConvertToObject(f,function(a){e(a)}),void 0;if(f.start&&!d[f.uuid]&&(d[f.uuid]=[],a.onBegin&&a.onBegin(f)),!f.end&&f.value&&d[f.uuid].push(f.value),f.end){for(var h=d[f.uuid],i=[],j=h.length,k=0;j>k;k++)h[k]&&i.push(h[k]);var l=new Blob(i,{type:f.type});l=c(l,f),l.url=URL.createObjectURL(l),l.uuid=f.uuid,l.size||console.error("Something went wrong. Blob Size is 0."),a.onEnd&&a.onEnd(l)}f.value&&a.onProgress&&a.onProgress(f),f.end||g(f.uuid)}var d={};return{receive:e}},SaveToDisk:function(a,b){var c=document.createElement("a");c.href=a,c.target="_blank",c.download=b||a;var d=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});c.dispatchEvent(d),(window.URL||window.webkitURL).revokeObjectURL(c.href)}},b={ConvertToArrayBuffer:function(a,b){binarize.pack(a,function(a){b(a.buffer)})},ConvertToObject:function(a,b){binarize.unpack(a,b)}};!function(a){var b=!1,c=!1,d=!0,e=Uint8Array.BYTES_PER_ELEMENT,f=Uint16Array.BYTES_PER_ELEMENT,g=Uint32Array.BYTES_PER_ELEMENT,h={NULL:0,UNDEFINED:1,STRING:2,NUMBER:3,BOOLEAN:4,ARRAY:5,OBJECT:6,INT8ARRAY:7,INT16ARRAY:8,INT32ARRAY:9,UINT8ARRAY:10,UINT16ARRAY:11,UINT32ARRAY:12,FLOAT32ARRAY:13,FLOAT64ARRAY:14,ARRAYBUFFER:15,BLOB:16,FILE:16,BUFFER:17};if(b)var i=["NULL","UNDEFINED","STRING","NUMBER","BOOLEAN","ARRAY","OBJECT","INT8ARRAY","INT16ARRAY","INT32ARRAY","UINT8ARRAY","UINT16ARRAY","UINT32ARRAY","FLOAT32ARRAY","FLOAT64ARRAY","ARRAYBUFFER","BLOB","BUFFER"];var j=[null,null,"Uint16","Float64","Uint8",null,null,"Int8","Int16","Int32","Uint8","Uint16","Uint32","Float32","Float64","Uint8","Uint8","Uint8"],k=function(a,b,d){var e=[],f=c,g=40;e[0]=[];for(var h=0;g>h;h++)e[0][h]=10>h?"0"+h.toString(10):h.toString(10);for(h=0;d>h;h++){var i=a.getUint8(b+h,f),j=~~(h/g)+1;"undefined"==typeof e[j]&&(e[j]=[]),e[j][h%g]=16>i?"0"+i.toString(16):i.toString(16)}for(console.log("%c"+e[0].join(" "),"font-weight: bold;"),h=1;h<e.length;h++)console.log(e[h].join(" "))},l=function(a){var b=void 0;if(void 0===a)b=h.UNDEFINED;else if(null===a)b=h.NULL;else{var c=a.constructor.name;if(void 0!==c)b=h[c.toUpperCase()];else switch(typeof a){case"string":b=h.STRING;break;case"number":b=h.NUMBER;break;case"boolean":b=h.BOOLEAN;break;case"object":a instanceof Array?b=h.ARRAY:a instanceof Int8Array?b=h.INT8ARRAY:a instanceof Int16Array?b=h.INT16ARRAY:a instanceof Int32Array?b=h.INT32ARRAY:a instanceof Uint8Array?b=h.UINT8ARRAY:a instanceof Uint16Array?b=h.UINT16ARRAY:a instanceof Uint32Array?b=h.UINT32ARRAY:a instanceof Float32Array?b=h.FLOAT32ARRAY:a instanceof Float64Array?b=h.FLOAT64ARRAY:a instanceof ArrayBuffer?b=h.ARRAYBUFFER:a instanceof Blob?b=h.BLOB:a instanceof Buffer?b=h.BUFFER:a instanceof Object&&(b=h.OBJECT)}}return b},o=function(d){var l=0,m=0,n=0,o=c,p=new ArrayBuffer(d[0].byte_length+d[0].header_size),q=new DataView(p);for(m=0;m<d.length;m++){var r=l,s=d[m].header_size,t=d[m].type,u=d[m].length,v=d[m].value,w=d[m].byte_length,x=j[t],y=null===x?0:a[x+"Array"].BYTES_PER_ELEMENT;switch(t===h.BUFFER?q.setUint8(l,h.BLOB,o):q.setUint8(l,t,o),l+=e,b&&console.info("Packing",t,i[t]),(t===h.ARRAY||t===h.OBJECT)&&(q.setUint16(l,u,o),l+=f,b&&console.info("Content Length",u)),q.setUint32(l,w,o),l+=g,b&&(console.info("Header Size",s,"bytes"),console.info("Byte Length",w,"bytes")),t){case h.NULL:case h.UNDEFINED:break;case h.STRING:for(b&&console.info('Actual Content %c"'+v+'"',"font-weight:bold;"),n=0;u>n;n++,l+=y)q.setUint16(l,v.charCodeAt(n),o);break;case h.NUMBER:case h.BOOLEAN:b&&console.info("%c"+v.toString(),"font-weight:bold;"),q["set"+x](l,v,o),l+=y;break;case h.INT8ARRAY:case h.INT16ARRAY:case h.INT32ARRAY:case h.UINT8ARRAY:case h.UINT16ARRAY:case h.UINT32ARRAY:case h.FLOAT32ARRAY:case h.FLOAT64ARRAY:var z=new Uint8Array(q.buffer,l,w);z.set(new Uint8Array(v.buffer)),l+=w;break;case h.ARRAYBUFFER:case h.BUFFER:var z=new Uint8Array(q.buffer,l,w);z.set(new Uint8Array(v)),l+=w;break;case h.BLOB:case h.ARRAY:case h.OBJECT:break;default:throw"TypeError: Unexpected type found."}b&&k(q,r,l-r)}return q},p=function(d,l){var q,r,s,t,u,m=0,n=c,o=l;q=d.getUint8(l,n),l+=e,b&&console.info("Unpacking",q,i[q]),(q===h.ARRAY||q===h.OBJECT)&&(r=d.getUint16(l,n),l+=f,b&&console.info("Content Length",r)),s=d.getUint32(l,n),l+=g,b&&console.info("Byte Length",s,"bytes");var v=j[q],w=null===v?0:a[v+"Array"].BYTES_PER_ELEMENT;switch(q){case h.NULL:case h.UNDEFINED:b&&k(d,o,l-o),t=null;break;case h.STRING:r=s/w;var x=[];for(m=0;r>m;m++){var y=d.getUint16(l,n);l+=w,x.push(String.fromCharCode(y))}t=x.join(""),b&&(console.info('Actual Content %c"'+t+'"',"font-weight:bold;"),k(d,o,l-o));break;case h.NUMBER:t=d.getFloat64(l,n),l+=w,b&&(console.info('Actual Content %c"'+t.toString()+'"',"font-weight:bold;"),k(d,o,l-o));break;case h.BOOLEAN:t=1===d.getUint8(l,n)?!0:!1,l+=w,b&&(console.info('Actual Content %c"'+t.toString()+'"',"font-weight:bold;"),k(d,o,l-o));break;case h.INT8ARRAY:case h.INT16ARRAY:case h.INT32ARRAY:case h.UINT8ARRAY:case h.UINT16ARRAY:case h.UINT32ARRAY:case h.FLOAT32ARRAY:case h.FLOAT64ARRAY:case h.ARRAYBUFFER:u=d.buffer.slice(l,l+s),l+=s,t=q===h.ARRAYBUFFER?u:new a[v+"Array"](u),b&&k(d,o,l-o);break;case h.BLOB:if(b&&k(d,o,l-o),a.Blob){var z=p(d,l),A=p(d,z.cursor);l=A.cursor,t=new Blob([A.value],{type:z.value})}else u=d.buffer.slice(l,l+s),l+=s,t=new Buffer(u);break;case h.ARRAY:for(b&&k(d,o,l-o),t=[],m=0;r>m;m++)u=p(d,l),l=u.cursor,t.push(u.value);break;case h.OBJECT:for(b&&k(d,o,l-o),t={},m=0;r>m;m++){var B=p(d,l),C=p(d,B.cursor);l=C.cursor,t[B.value]=C.value}break;default:throw"TypeError: Type not supported."}return{value:t,cursor:l}},q=function(a,b){for(var c=a.length,d=[],e=0,f=0,g=0;g<a.length;g++)!function(g){r(a[g],function(a){if(d[g]=a,f+=a[0].header_size+a[0].byte_length,++e===c){for(var h=[],i=0;i<d.length;i++)h=h.concat(d[i]);b(h,f)}})}(g)},r=function(b,c){var m,d=[],i=1,k=e+g,n=0,o=0,p=b;switch(m=l(b),i=void 0===j[m]||null===j[m]?0:a[j[m]+"Array"].BYTES_PER_ELEMENT,m){case h.UNDEFINED:case h.NULL:break;case h.NUMBER:case h.BOOLEAN:n=i;break;case h.STRING:o=b.length,n+=o*i;break;case h.INT8ARRAY:case h.INT16ARRAY:case h.INT32ARRAY:case h.UINT8ARRAY:case h.UINT16ARRAY:case h.UINT32ARRAY:case h.FLOAT32ARRAY:case h.FLOAT64ARRAY:o=b.length,n+=o*i;break;case h.ARRAY:return q(b,function(a,d){c([{type:m,length:b.length,header_size:k+f,byte_length:d,value:null}].concat(a))}),void 0;case h.OBJECT:var r=[];for(var s in b)b.hasOwnProperty(s)&&(r.push(s),r.push(b[s]),o++);return q(r,function(a,b){c([{type:m,length:o,header_size:k+f,byte_length:b,value:null}].concat(a))}),void 0;case h.ARRAYBUFFER:n+=b.byteLength;break;case h.BLOB:var t=b.type,u=new FileReader;return u.onload=function(a){q([t,a.target.result],function(a,b){c([{type:m,length:o,header_size:k,byte_length:b,value:null}].concat(a))})},u.onerror=function(a){throw"FileReader Error: "+a},u.readAsArrayBuffer(b),void 0;case h.BUFFER:n+=b.length;break;default:throw'TypeError: Type "'+b.constructor.name+'" not supported.'}c([{type:m,length:o,header_size:k,byte_length:n,value:p}].concat(d))},s=function(a){var c=a instanceof DataView?a:new DataView(a),d=p(c,0);return d.value};b&&(a.Test={BIG_ENDIAN:c,LITTLE_ENDIAN:d,Types:h,pack:o,unpack:p,serialize:r,deserialize:s});var t={pack:function(a,c){try{b&&console.info("%cPacking Start","font-weight: bold; color: red;",a),r(a,function(a){b&&console.info("Serialized Object",a),c(o(a))})}catch(d){throw d}},unpack:function(a,c){try{b&&console.info("%cUnpacking Start","font-weight: bold; color: red;",a);var d=s(a);b&&console.info("Deserialized Object",d),c(d)}catch(e){throw e}}};"undefined"!=typeof module&&module.exports?module.exports=t:a.binarize=t}("undefined"!=typeof global?global:this)}();